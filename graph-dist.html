<style type="text/css">
.highcharts-figure,
.highcharts-data-table table {
    min-width: 310px;
    max-width: 800px;
    margin: 1em auto;
}

#container {
    height: auto;
}

.highcharts-data-table table {
    font-family: Verdana, sans-serif;
    border-collapse: collapse;
    border: 1px solid #EBEBEB;
    margin: 10px auto;
    text-align: center;
    width: 100%;
    max-width: 500px;
}

.highcharts-data-table caption {
    padding: 1em 0;
    font-size: 1.2em;
    color: #555;
}

.highcharts-data-table th {
    font-weight: 600;
    padding: 0.5em;
}

.highcharts-data-table td,
.highcharts-data-table th,
.highcharts-data-table caption {
    padding: 0.5em;
}

.highcharts-data-table thead tr,
.highcharts-data-table tr:nth-child(even) {
    background: #f8f8f8;
}

.highcharts-data-table tr:hover {
    background: #f1f7ff;
}
</style>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<figure class="highcharts-figure">
    <form class="dist-from">
        <select id="dist">
        </select>
    </form>
    <div id="container"></div>
    <p class="highcharts-description">
        
    </p>
</figure>
<script>
const Adapter = {
    read: (theUrl, callback) => {
        $.ajax({
            url: theUrl,
            dataType: 'jsonp',
            success: callback
        });
    }
}
Adapter.read('/dist', function(results) {
    console.log(results);
    let options = "";
    results.forEach(function(dist) {
        options += `<option value="${dist}">${dist}</option>`
    });
    let sel = document.getElementById("dist");
    sel.innerHTML = options;
});
// $(".dist-from").change(function() {
//     alert(this.value);
// });
$('select').on('change', function() {
  //alert( this.value );
  showGraph(this.value);
});
function showGraph(dist) {
    Adapter.read(`/bybrands/${encodeURI(dist.split("/").join(""))}`, function(results) {
        console.log(results);

        Highcharts.chart('container', {
            chart: {
                type: 'bar'
            },
            title: {
                text: 'DD India data - DO11SEP2019-881 Analysi for '+results.dist
            },
            subtitle: {
                text: 'Source: <a href="https://docs.google.com/spreadsheets/d/1NWNFnVyMZ10AwnwFeAirC5vQNh2MgORywAfRckUFVPw/edit#gid=0">Google Sheet</a>'
            },
            xAxis: {
                //categories: ['Africa', 'America', 'Asia', 'Europe', 'Oceania'],
                categories: results.categories,

                title: {
                    text: null
                }
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Number (Quantity)',
                    align: 'high'
                },
                labels: {
                    overflow: 'justify'
                }
            },
            tooltip: {
                valueSuffix: ''
            },
            plotOptions: {
                bar: {
                    dataLabels: {
                        enabled: true
                    }
                }
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'top',
                x: -40,
                y: 80,
                floating: true,
                borderWidth: 1,
                backgroundColor: Highcharts.defaultOptions.legend.backgroundColor || '#FFFFFF',
                shadow: true
            },
            credits: {
                enabled: false
            },
            "series": results.series
        });
    });
}
</script>